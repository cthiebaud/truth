import{Offcanvas as e,Carousel as t,Modal as s}from"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/+esm";import i from"https://cdn.jsdelivr.net/npm/bezier-easing@2.1.0/+esm";import n from"https://cdn.jsdelivr.net/npm/isotope-layout@3.0.6/+esm";import r from"https://cdn.jsdelivr.net/npm/showdown@2.1.0/+esm";import o from"https://cdn.jsdelivr.net/npm/tinycolor2@1.6.0/+esm";import{Howler as l,Howl as a}from"https://cdn.jsdelivr.net/npm/howler@2.2.4/+esm";class c{#e;#t;#s;#i;constructor(e,t,s){this.#e=e,this.#s=document.getElementById(t),this.#t=s,this.#i=new r.Converter({tables:!0,strikethrough:!0})}safeById=(e,t)=>{if(!e||!this.#s)return;const s=this.#s.querySelector("#"+e);return s?t(s):void 0};display(e){const t=this.#s.querySelector(".offcanvas-body");if(!t)throw new Exception("no element where to insert response text");const s=t.lastElementChild,i=this.#i.makeHtml(e);s?s.innerHTML=i:t.innerHTML=i,this.#s.querySelectorAll("table:not(.table)").forEach((e=>{e.classList.add("table","table-sm","table-borderless")})),this.#s.querySelectorAll("img").forEach((e=>{e.alt&&!(e.alt.includes("Android")||e.alt.includes("Apple")||e.alt.includes("example")||e.alt.includes("github"))&&e.classList.add("img-fluid")})),this.safeById("logic_symbols",(e=>{e.addEventListener("click",(e=>{e.preventDefault(),this.#s.classList.remove("javascript"),this.safeById("AetB",(e=>e.innerHTML="𝖠 ∧ 𝖡")),this.safeById("AouB",(e=>e.innerHTML="𝖠 ∨ 𝖡")),this.safeById("nonAounonB",(e=>e.innerHTML="¬𝖠 ∨ ¬𝖡"))}))})),this.safeById("javascript_expressions",(e=>{e.addEventListener("click",(e=>{e.preventDefault(),this.#s.classList.add("javascript"),this.safeById("AetB",(e=>e.innerHTML="α & β")),this.safeById("AouB",(e=>e.innerHTML="α | β")),this.safeById("nonAounonB",(e=>e.innerHTML="!α | !β"))}))}))}fetch(e){if(this.#t){const t=this,s=new XMLHttpRequest;s.open("GET",this.#t,!0),s.onreadystatechange=function(){4===s.readyState&&200===s.status&&(t.display(s.responseText),e&&e())},s.send()}return new this.#e(this.#s)}}class d{static safeGetElementByIdThen(e,t,...s){if(e){const i=document.getElementById(e);if(i)return t(i,...s)}}static normalizeVraiment(e,t,s,i,n){if(s===t)return 0;if(Math.abs(e-s)<Number.EPSILON)return n;return i+(n-i)*(e-t)/(s-t)}static isFiniteNumber(e){return isFinite(e)&&!isNaN(e)}static formatDuration(e,t="seconds"){if("seconds"!==t&&"milliseconds"!==t)throw new Error("Invalid 'type' parameter. 'type' must be either 'seconds' or 'milliseconds'.");if("seconds"===t&&(e*=1e3),6e5<=e)throw new Error(`Duration ${e} must be under 9′59″9999`);const s=Math.floor(e/6e4),i=Math.floor(e/1e3)%60;let n=s+"′"+String(i).padStart(2,"0")+"″";if("milliseconds"===t){const t=Math.floor(e%1e3);n+=String(t).padStart(4,"0")}return n}static shuffleArray(e){for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}}static toggleElementsVisibility(e,t){let s=null;for(let i of e)null==s&&(s=i.style.display!==t?t:"none"),i.style.display=s;return s}}class u{static mapNumberToColor(e){const t=[{value:120,color:"#00852B"},{value:60,color:"#1E5AA8"},{value:30,color:"#B40000"},{value:0,color:"#FF0000"}];if(t[0].value<e)return t[0].color;if(e<=t[t.length-1].value)return t[t.length-1].color;let s=null;for(let i=0;i<t.length-1;i++)if(t[i].value>=e&&e>t[i+1].value){s=i;break}if(null===s)return"#000000";const i=(e-t[s].value)/(t[s+1].value-t[s].value);return o.mix(t[s].color,t[s+1].color,100*i).toHexString()}constructor(){let e=["#F4F4F4","#FAC80A","#B40000","#00852B","#1E5AA8","#8A928D","#ABD9FF","#91501C","#545955"],t=Math.floor(Math.random()*e.length);this.colorTrue=e[t],this.colorFalse="transparent",e.splice(t,1),this.colors=[...e,...e],this.shuffleColors(4)}#n=4;#r=0;nextColor(){const e=this.colors[this.#r++];return this.#r%=this.colors.length,e}shuffleColors(e=this.#n){return this.colors=function(e,t){e.length;let s=[...e],i=new Map,n=[];for(let e=0;e<s.length;e++)i.has(s[e])?i.set(s[e],i.get(s[e])+1):i.set(s[e],1);if(t||(t=0),t<0||i.size<t)throw new Error("Invalid parameters: lengthOfNonConsecutiveColors should be a number greater or equal than zero and less than the length of possible colors array");let r=[];for(;;){let e=[];if(i.forEach(((t,s)=>{t>0&&!n.includes(s)&&e.push({value:s,remain:t})})),0===e.length)break;let s=Math.floor(Math.random()*e.length),o=e[s];r.push(o.value),n.push(o.value),n.length>t&&n.shift(),i.set(o.value,o.remain-1);let l=!0;if(i.forEach((e=>{e>0&&(l=!1)})),l)break}return r}(this.colors,e),this.colors}bg2color(e){return o(e).darken(3).toString("hex6")}}class h{static overlaySingleton=null;static getOrCreateOverlaySingleton(){return null==h.overlaySingleton&&(h.overlaySingleton=document.createElement("div"),h.overlaySingleton.classList.add("overlay"),h.overlaySingleton.style.display="none",document.body.appendChild(h.overlaySingleton),window.addEventListener("resize",(()=>{(new h).updateOverlayPosition()}))),h.overlaySingleton}#o;#l;constructor(e){this.#l=e,this.#o=h.getOrCreateOverlaySingleton()}show(){this.#o.style.display="block"}move(e){this.elementCoveredByOverlay=e,this.updateOverlayPosition()}hide(){this.#o.style.display="none"}clear(){this.#o.style.display="none",this.elementCoveredByOverlay=null}updateOverlayPosition(){if(null==this.elementCoveredByOverlay)return;const e=this.elementCoveredByOverlay.querySelectorAll(this.#l);if(0===e.length)return;let t=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER;e.forEach((e=>{const r=e.getBoundingClientRect();t=Math.min(t,r.top),s=Math.min(s,r.left),i=Math.max(i,r.bottom),n=Math.max(n,r.right)}));const r=this.#o.parentElement.getBoundingClientRect();this.elementCoveredByOverlay.getBoundingClientRect();const o=this.#o.style;o.position="absolute",o.top=t-r.top+"px",o.left=s-r.left+"px",o.width=n-s+"px",o.height=i-t+"px"}}class m{constructor(e,t){if(this.swipeArea=document.getElementById(e),!this.swipeArea)throw new Error(`Element with id '${e}' not found.`);this.startX=0,this.startY=0,this.currentX=0,this.minY=0,this.maxY=0,this.touchThresholdX=150,this.touchThresholdY=80,this.swipeHandler=t,this.swipeArea.addEventListener("touchstart",this.handleTouchStart.bind(this),{passive:!1}),this.swipeArea.addEventListener("touchmove",this.handleTouchMove.bind(this),{passive:!1}),this.swipeArea.addEventListener("touchend",this.handleTouchEnd.bind(this),{passive:!1}),this.swipeElement=this.swipeArea,this.swipeElement.addEventListener("swipe",this.handleSwipe.bind(this))}handleTouchStart(e){this.startX=this.currentX=e.touches[0].clientX,this.startY=this.minY=this.maxY=e.touches[0].clientY}handleTouchMove(e){this.currentX=e.touches[0].clientX,this.minY=Math.min(this.minY,e.touches[0].clientY),this.maxY=Math.max(this.maxY,e.touches[0].clientY)}handleTouchEnd(e){if(!(this.startX&&this.currentX&&this.startY&&this.minY))return;const t=this.currentX-this.startX,s=this.maxY-this.minY;Math.abs(t)>this.touchThresholdX&&Math.abs(s)<this.touchThresholdY&&(t>0?this.fireSwipeEvent("swiperight"):this.fireSwipeEvent("swipeleft")),this.startX=this.currentX=void 0}fireSwipeEvent(e){const t=new CustomEvent("swipe",{detail:e});this.swipeElement.dispatchEvent(t)}handleSwipe(e){"function"==typeof this.swipeHandler&&this.swipeHandler(e.detail)}}class p{constructor(e,t,s={}){try{this.timerContainer=document.getElementById(t),this.timerContainer.disabled=!1,this.timerElementPlaying=this.timerContainer.querySelector(".timer-playing"),this.timerElementNotPlaying=this.timerContainer.querySelector(".timer-not-playing"),this.ticks=0,this.innerCircle1=this.timerElementPlaying.querySelector("#innerCircle1"),this.innerCircle2=this.timerElementPlaying.querySelector("#innerCircle2"),this.radius1=this.innerCircle1.getAttribute("r"),this.radius2=this.innerCircle2.getAttribute("r"),this.circonf1=2*this.radius1*Math.PI,this.circonf2=2*this.radius2*Math.PI,this.radius=this.timerElementPlaying.width/4,this.centerX=this.timerElementPlaying.width/2,this.centerY=this.timerElementPlaying.height/2,this.timerId=null,this.startTime=null,this.stopTime=null,this.totalTime=e,this.callbacks={onStart:()=>{},onTick:()=>{},onExpired:()=>{},onStop:()=>{},onClose:()=>{}},this.callbacks=Object.assign(this.callbacks,s)}catch(e){console.error(e)}}drawTimer(e){let t=(this.totalTime-e)/this.totalTime,s=t*this.circonf1,i=this.circonf1-s,n=t*this.circonf2,r=this.circonf2-n;innerCircle1.setAttribute("stroke-dasharray",`0 ${s} ${i}`),n-6>=0?(innerCircle2.setAttribute("stroke-dasharray",`0 3 ${n-6} ${r+3}`),innerCircle2.setAttribute("stroke-width",2)):innerCircle2.setAttribute("stroke-width",0)}updateTimer(e){const t=(e-this.startTime)/1e3,s=Math.max(this.totalTime-t,0);s>0?(this.drawTimer(s),this.timerId=requestAnimationFrame((e=>this.updateTimer(e)))):(clearInterval(this.showNumber),this.callbacks.onExpired())}start(e){e&&(this.totalTime=e),this.timerElementPlaying.style.display="block",this.timerElementNotPlaying.style.display="none",this.ticks=0,this.stopTime=null,this.startTime=performance.now(),this.timerId=requestAnimationFrame((e=>this.updateTimer(e,this.startTime))),this.callbacks.onStart(),this.callbacks.onTick(this.totalTime,this.ticks),this.showNumber=setInterval((()=>{this.callbacks.onTick(this.totalTime,++this.ticks)}),1e3)}stop(){return null!==this.stopTime||(clearInterval(this.showNumber),cancelAnimationFrame(this.timerId),this.timerId=null,this.callbacks.onStop(),this.stopTime=performance.now()-this.startTime),this.stopTime}close(){this.callbacks.onClose(),this.timerElementPlaying.style.display="none",this.timerElementNotPlaying.style.display="block"}}class y{static newHowl(e){if(!l.usingWebAudio)return{play:()=>{},fade:()=>{},stop:()=>{},volume:()=>{}};return new class extends a{constructor(e){super(e),this._initialVolume=e.volume}play(e){this._initialVolume&&this.volume(this._initialVolume),super.play(e)}fade(e,t,s,i){void 0===e&&(e=this.volume()),void 0===s&&(s=1e3),super.fade(e,t,s,i)}}(e)}constructor(){this.tortoise=y.newHowl({src:["/assets/audio/ticking.mp3"],loop:!0,volume:.5}),this.hare=y.newHowl({src:["/assets/audio/hare.mp3"],loop:!1,volume:.3}),this.achilles=y.newHowl({src:["/assets/audio/achilles-v9.mp3"],loop:!1,volume:.8}),this.underwater=y.newHowl({src:["/assets/audio/underwater-v2.mp3"],loop:!0,volume:.001}),this.coin=y.newHowl({src:["/assets/audio/coin.mp3"]}),this.laughs=y.newHowl({src:["/assets/audio/guitar-string-snap.mp3"],loop:!1,volume:.2}),this.tada=y.newHowl({src:["/assets/audio/tada.mp3"],loop:!1,volume:.8}),this.fail=y.newHowl({src:["/assets/audio/fail2.mp3"]}),this.completed_with_errors=y.newHowl({src:["/assets/audio/completed_with_errors.mp3"]}),this.boo=y.newHowl({src:["/assets/audio/boo.mp3"]}),this.guitar=y.newHowl({src:["/assets/audio/guitar-riff.mp3"]}),this.boredom=y.newHowl({src:["/assets/audio/boredom.mp3"]}),this.gong=y.newHowl({src:["/assets/audio/gong.mp3"],loop:!1,volume:.3}),this.abort=y.newHowl({src:["/assets/audio/short-whoosh.mp3"]}),this.riser=y.newHowl({src:["/assets/audio/scary-riser-v2.mp3"],loop:!1,volume:.67})}}class v{#a;constructor(e){this.#a=e}get value(){return this.#a}set value(e){"number"==typeof e?this.#a=e:console.error("Value must be a number")}increment(){const e=this.#a;return this.#a+=1,e}}class g{#c;#d;#u;#h;#m;#p;#y;constructor(e,t,s){this.#m=e,this.#y=t,this.#p=s,this.reset()}reset(){this.#c=void 0,this.#d=new v(1),this.#u=new v(0),this.#h=new v(0)}get level(){return this.#m}get scrambled(){return this.#y}get displayModeSymbol(){return this.#p}get elapsed(){return this.#d}get erred(){return this.#u}get unconcealed(){return this.#h}get timerDuration(){return this.#c}set timerDuration(e){this.#c=e}get victory(){return 0===this.erred.value&&32===this.unconcealed.value}}const f=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document;console.log(navigator.userAgent,`[${f?"":"NOT "}a iOS device]`);class b{#s;#v=i(.5,.2,.5,1);#g;#f;#b;constructor(){this.#s=document.querySelector(".compte-à-rebours"),this.#g=120,this.#b=600}get animationTimeInMilliseconds(){return this.#b}set animationTimeInMilliseconds(e){this.#b=e}get duration(){return this.#g}set duration(e){this.animateSetDuration(e)}animateSetDuration(e){let t=Number(e),s=this.duration;const i=performance.now(),n=()=>{const e=Math.min(performance.now()-i,this.#b),r=d.normalizeVraiment(e,0,this.#b,0,1),o=this.#v(r),l=s+o*(t-s);this._duration_=l,e<this.animationTimeInMilliseconds?requestAnimationFrame(n):this._duration_=t};cancelAnimationFrame(this.#f),this.#f=requestAnimationFrame(n)}set _duration_(e){if(!d.isFiniteNumber(e))throw new Error(`not a finite number: ${e} !`);this.#g=e,this.#s.style.color=u.mapNumberToColor(this.#g),this.#s.textContent=d.formatDuration(this.#g)}}let w=null;w=new class{#w;constructor(e){this.#w=document.getElementById(e)}get element(){return this.#w}set innerHTML(e){this.#w&&(this.#w.innerHTML=e)}}("tables");let E=null;E=new class{#E;constructor(){let e;document.getElementById("result-modal").addEventListener("hidden.bs.modal",(e=>{E.stop()})),this.restarting=!1,this._soundMachine=new y,document.getElementById("controls").style.visibility="visible",this.compteARebours=new b,this.compteARebours.duration=Number(document.querySelector(".carousel-item.active").dataset.time),this._timer=new p(this.compteARebours.duration,"play",{onStart:this.onTimerStart,onTick:this.onTimerTick,onExpired:this.onTimerExpired,onStop:this.onTimerStop,onClose:this.onTimerClose}),this.tortoiseHareAchilles=new t(document.getElementById("tortoise-hare-achilles"),{}),document.getElementById("tortoise-hare-achilles").addEventListener("slide.bs.carousel",(t=>{e=performance.now(),this.compteARebours.animateSetDuration(t.relatedTarget.dataset.time)})),document.getElementById("tortoise-hare-achilles").addEventListener("slid.bs.carousel",(t=>{e&&(this.compteARebours.animationTimeInMilliseconds=performance.now()-e);const s=document.getElementById("tortoise-hare-achilles"),i=s.querySelector(".carousel-item.active");s.style.opacity="1",s.querySelector(".carousel-control-next").disabled=!1,s.querySelector(".carousel-control-prev").disabled=!1,"tortoise"===i.id?s.querySelector(".carousel-control-prev").disabled=!0:"achilles"===i.id&&(s.querySelector(".carousel-control-next").disabled=!0)}))}get restarting(){return this.#E}set restarting(e){this.#E=e}get level(){return document.querySelector(".carousel-item.active").dataset.sound}stopTimerShowResultThenCloseTimer(e,t){E.result.timerDuration=E._timer.stop(),document.getElementById("result-msg").innerHTML=e,[...document.querySelectorAll("#cloche svg")].forEach((e=>{e.style.display="none"})),d.safeGetElementByIdThen("result-display-mode-symbol",((e,t)=>{e.innerHTML=t}),t.displayModeSymbol),document.getElementById(`result-level-${t.level}`).style.display="block",document.getElementById(`result-scrambled-${t.scrambled}`).style.display="block",document.getElementById("result-elapsed").innerHTML=d.formatDuration(t.timerDuration,"milliseconds"),document.getElementById("result-unconcealed").innerHTML=t.unconcealed.value,0!==t.erred.value?(document.getElementById("empty-set").style.display="none",document.getElementById("result-erred").innerHTML=t.erred.value):(document.getElementById("result-erred").innerHTML="",document.getElementById("empty-set").style.display="block");const i=new Date;d.safeGetElementByIdThen("result-timestamp",((e,t)=>{e.innerHTML=t}),i.toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})),new s(document.getElementById("result-modal")).show()}onTimerStart(){E._soundMachine.underwater.play(),E._soundMachine[E.level].play()}onTimerTick(e,t){E.compteARebours.duration=e-t,E.result.elapsed.increment(),E.compteARebours.duration<=17&&!E._soundMachine.riser.playing()&&E._soundMachine.riser.play()}onTimerExpired(){requestAnimationFrame((()=>{let e;0===E.result.erred.value&&0===E.result.unconcealed.value?(E.boredom(),e="Rather quiet today, isn't it?"):(E.fail(),e="Time's up!"),E.stopTimerShowResultThenCloseTimer(e,E.result)}))}onTimerStop(){"achilles"===E.level?E.result.victory||E._soundMachine[E.level].fade(void 0,.001,2500):E._soundMachine[E.level].fade(void 0,.001),E._soundMachine.underwater.fade(void 0,.001),E._soundMachine.riser.fade(void 0,.001,1500)}onTimerClose(){document.getElementById("shuffle-all").disabled=!1,E.unveilBricks(),E._soundMachine[E.level].stop(),E._soundMachine.underwater.stop()}victory(){requestAnimationFrame((()=>{let e;E.result.erred.value>=32&&0===E.result.unconcealed.value?(E.guitar(),e="Ooooh&hellip; Subtle!"):0===E.result.erred.value&&32===E.result.unconcealed.value?("achilles"==E.level&&E.result.victory?E.gong():E.tada(),e="You won!"):E.result.erred.value>=28&&32===E.result.unconcealed.value?(E.boo(),e="You cheated?!"):(E.completed_with_errors(),e="You <i>quasi</i> won&hellip;"),E.stopTimerShowResultThenCloseTimer(e,E.result)}))}get isPlaying(){return document.getElementById("play").classList.contains("playing")}set isPlaying(e){this.isPlaying!==e&&(e?document.getElementById("play").classList.add("playing"):document.getElementById("play").classList.remove("playing"))}coin(){this._soundMachine.coin.play()}tada(){this._soundMachine.tada.play()}gong(){this._soundMachine.gong.play()}laughs(){this._soundMachine.laughs.play(),this.result.erred.increment()}fail(){this._soundMachine.fail.play()}abortSound(){this._soundMachine.abort.play()}completed_with_errors(){this._soundMachine.completed_with_errors.play()}boo(){this._soundMachine.boo.play()}guitar(){this._soundMachine.guitar.play()}boredom(){this._soundMachine.boredom.play()}veilBricks(){this.#T("veil")}unveilBricks(){this.restarting||this.#T("unveil")}async#T(e){const t="veil"===e;function s(t,s){return new Promise((i=>{t.parentNode.classList.remove("completed");const n=t.querySelectorAll("td");s?n.forEach((e=>{e.classList.contains("true")&&e.classList.add("concealed"),e.classList.remove("clicked")})):1!=E.isPlaying&&n.forEach((e=>{e.classList.contains("true")&&e.classList.remove("concealed"),e.classList.remove("clicked")})),setTimeout((()=>{console.log(e,t.id,performance.now()),i(t)}),20)}))}const i=[...document.querySelectorAll("#tables tbody")],n=Array.from({length:i.length},((e,t)=>t));d.shuffleArray(n);for(const e of n){const n=i[e];await s(n,t)}}start(){if(this.isPlaying)return;this.isPlaying=!0,this.result=new g(this.level,w.element.dataset.scrambled,L.displayMode.symbol),window.scrollTo({top:0,behavior:"smooth"}),this.veilBricks();const e=Number(document.querySelector(".carousel-item.active").dataset.time);this._timer.start(e),document.getElementById("shuffle-all").disabled=!0,document.getElementById("tortoise-hare-achilles").style.opacity=".5",document.querySelectorAll("#tortoise-hare-achilles button").forEach((e=>{e.disabled=!0})),this.result.reset(),this.restarting=!1}abort(){requestAnimationFrame((()=>{E.abortSound();E.stopTimerShowResultThenCloseTimer("You stopped!",E.result)}))}stop(){this.isPlaying=!1,this.compteARebours.duration=Number(document.querySelector(".carousel-item.active").dataset.time);const e=document.getElementById("tortoise-hare-achilles"),t=e.querySelector(".carousel-item.active");e.style.opacity="1",e.querySelector(".carousel-control-next").disabled=!1,e.querySelector(".carousel-control-prev").disabled=!1,"tortoise"===t.id?e.querySelector(".carousel-control-prev").disabled=!0:"achilles"===t.id&&(e.querySelector(".carousel-control-next").disabled=!0),this.result&&(this.result.timerDuration=this._timer.stop()),this._timer.close()}};const T=new class{constructor(){this.axesArray=[null,!0,!1],this.visible=!1,this.setCellWidth()}setCellWidth(){let e=61;this.visible&&(e=52);let t=Math.round(.8*e);document.documentElement.style.setProperty("--cell-width_and_height",`${e}px`),document.documentElement.style.setProperty("--cell-width_and_height-smaller",`${t}px`),document.documentElement.style.setProperty("--header-width_and_height","18px"),document.documentElement.style.setProperty("--border-color","#215c4d40")}iterate(e){this.axesArray.forEach(e)}applyVisibility(){(e=>{for(let t of e)t.style.display=this.visible?"table-cell":"none"})(document.querySelectorAll("#tables th"))}toggleVisibility(){const e=d.toggleElementsVisibility(document.querySelectorAll("#tables th"),"table-cell");return this.visible="none"!==e,this.setCellWidth(),this.visible}},M=new u;class S{constructor(e,t){this.c=0,this.colors=[e],t&&this.colors.push(t)}next(){const e=this.colors[this.c];return this.c=(this.c+1)%this.colors.length,e}}class I{static falseFunc="";static trueFunc="true";#M=[I.falseFunc,"α & β","α & !β","!α & !β","!α & β","α","β","!α","!β","α ^ β","α ^ !β","α | β","α | !β","!α | !β","!α | β",I.trueFunc];#S={canonical:{symbol:"𝖠",facade:"(𝖠,𝖡)",key:"canonical"},javascript:{symbol:"α",facade:"(α,β)",key:"javascript"}};#I="canonical";constructor(){const e="<span class='negation canonical'>𝖠</span>",t="<span class='negation canonical'>𝖡</span>";this.#M.forEach((s=>{if("string"==typeof s){const i=s;this.#S.javascript[i]=s.replace(/^$/g,"&nbsp;"),this.#S.canonical[i]=s.replace(/&/g,"∧").replace(/\|/g,"∨").replace(new RegExp(`^${I.trueFunc}$`),"⊤").replace(new RegExp(`^${I.falseFunc}$`),"⊥").replace(/\^/g,"⊻").replace(/(!?)α|(!?)β/g,((s,i,n)=>"!"===i?e:"!"===n?t:"α"===s?"𝖠":"𝖡"))}}))}static toAnonymous(e){return new Function("α","β",`return ${e};`)}iterate(e){this.#M.forEach(e)}getOneOrTwoColors(e){return e===I.falseFunc?new S(M.colorFalse):e===I.trueFunc?new S(M.colorTrue):e.includes("^")?new S(M.nextColor(),M.nextColor()):new S(M.nextColor())}toggleDisplayMode(){return this.#I="canonical"===this.#I?"javascript":"canonical",this.#I}get displayMode(){return this.#S[this.#I]}}const L=new I;let A;function B(e,t=!0){t?(w.element.dataset.scrambled=!0,A.shuffle()):(w.element.dataset.scrambled=!1,A.arrange({sortBy:"original-order"})),A.layout()}document.querySelector("#αβ > span").innerHTML=L.displayMode.facade;class k{#L=void 0;#A=null;constructor(e){this.#L=e,this.#A=null}blend(e,t){null===this.#A?this.#L.innerHTML=e:this.#A.insertAdjacentHTML("afterend",e),this.#A=document.getElementById(t)}}window.addEventListener("load",(t=>{const i=function(){if(E.isPlaying)return;const e=new k(w);L.iterate(((t,s)=>{const i=`element${s}`,n=`thead${s}`,r=`tbody${s}`,o=`<div id="${i}" class="ISOTOPE" data-function="${t}">\n<table class="table inline table-sm caption-top table-borderless">\n<caption class="text-center">${L.displayMode[t]}</caption>\n<thead id="${n}"></thead>\n<tbody id="${r}"></tbody>\n</table>\n</div>\n`;e.blend(o,i);let l=L.getOneOrTwoColors(t);T.iterate((e=>{const s=document.createElement("tr");T.iterate((i=>{const n=document.createElement(null===e||null===i?"th":"td");if(null===i)n.innerHTML=null===e?'<div class="diagonal-line">&nbsp;</div>':`<div class="vertical-text">${e}</div>`;else if(null===e)n.innerHTML=`${i}`;else{const s=I.toAnonymous(t)(e,i);n.classList.add(s?"true":"false"),s?(n.style.backgroundColor=l.next(),n.style.color=M.bg2color(n.style.backgroundColor),n.innerHTML=""):(n.style.backgroundColor=M.colorFalse,n.innerHTML="")}s.appendChild(n)})),document.getElementById(null===e?n:r).appendChild(s)})),T.applyVisibility()})),document.getElementById("aletheia").style.visibility="visible",document.querySelectorAll("#tables td").forEach((e=>{e.addEventListener("click",(t=>{if(t.preventDefault(),t.stopPropagation(),!E.isPlaying)return;if(e.classList.contains("concealed")){function n(e,t){for(;e=e.parentElement;)if(e.classList.contains(t))return e;return null}function r(e,t,s,i){const r=n(e,t);return r?{result:[...r.getElementsByClassName(s)].every((function(e){return!e.classList.contains(i)})),ancestor:r}:{result:!1,ancestor:void 0}}e.classList.remove("concealed"),E.result.unconcealed.increment();const o=r(e,"table","true","concealed");o.result&&(o.ancestor.classList.add("completed"),E.coin())}else e.classList.contains("false")&&(E.laughs(),e.classList.add("red-cross"),e.classList.add("clicked"),setTimeout((()=>{e.classList.remove("red-cross")}),1e3));let s=document.querySelectorAll("#tables td.true.concealed").length,i=document.querySelectorAll("#tables td.false.clicked").length;(0===s||i>=32&&32===s)&&E.victory()}))}));let t=null,s=new h("td");function i(){t&&(clearTimeout(t),t=null),[...document.querySelectorAll(".hint")].forEach((e=>{e.classList.remove("hint")})),s.hide(),E._soundMachine.underwater.fade(void 0,.001,1500)}return window.addEventListener("scroll",(function(e){i()})),window.addEventListener("touchmove",(function(e){i()})),[...document.getElementsByTagName("caption")].forEach((e=>{f&&e.addEventListener("touchstart",(e=>{e.preventDefault()})),e.addEventListener("pointerdown",(i=>{E.isPlaying&&(s.move(e.parentNode),s.show(),e.setPointerCapture(i.pointerId),E._soundMachine.underwater.fade(void 0,.4),t=setTimeout((()=>{i.target.parentNode.classList.add("hint"),i.target.parentNode.parentNode.classList.add("hint")}),300))})),e.addEventListener("pointerup",(t=>{i(),e.releasePointerCapture(t.pointerId)}))})),A=new n(w.element,{itemSelector:"div.ISOTOPE",layoutMode:"masonry",masonry:{columnWidth:10,fitWidth:!0}}),[...document.querySelectorAll("#tables>div")]}();function r(){E.isPlaying||B()}function o(){E.isPlaying||function(e){M.shuffleColors(),e.forEach((e=>{if(e.dataset.function){let t=L.getOneOrTwoColors(e.dataset.function);e.querySelectorAll("td.true").forEach((e=>{e.style.backgroundColor=t.next(),e.style.color=M.bg2color(e.style.backgroundColor)}))}}))}(i)}function l(){return function(e,t){if(!e)return;const s=document.getElementById(e);return s?t(s):void 0}("tables",(e=>e.classList.contains("transparent-border")?(e.classList.remove("transparent-border"),!1):(e.classList.add("transparent-border"),!0)))}function a(){return L.toggleDisplayMode(),"canonical"===L.displayMode.key?document.getElementById("main-id").classList.remove("javascript"):document.getElementById("main-id").classList.add("javascript"),document.getElementById("canonical-or-javascript.label").innerHTML=L.displayMode.symbol,document.querySelector("#αβ > span").innerHTML=L.displayMode.facade,document.querySelectorAll("#tables [data-function] caption").forEach((e=>{e.innerHTML=L.displayMode[e.parentNode.parentNode.dataset.function]})),"canonical"!==L.displayMode.key}document.getElementById("table-borders").addEventListener("click",(e=>{e.stopPropagation(),l()})),document.getElementById("ab-axes").addEventListener("click",(e=>{e.stopPropagation(),T.toggleVisibility()})),document.getElementById("canonical-or-javascript")?.addEventListener("click",(e=>{e.stopPropagation(),a()}));const d=new c(e,"offcanvas-right","/QUICK-GUIDE.md").fetch((()=>{console.log("/QUICK-GUIDE.md fetched")})),u=new c(e,"offcanvas-left","/WIP.md").fetch((()=>{console.log("/WIP.md fetched")}));function p(e){e.preventDefault(),e.stopPropagation(),E.isPlaying?E.abort():E.start()}function y(){E.restarting=!0,E.veilBricks();let e=document.getElementById("result-modal");e.addEventListener("hidden.bs.modal",(e=>{requestAnimationFrame((()=>{r(),E.start()}))}),{once:!0}),s.getInstance(e).hide()}new m("body-id",(function(e){"swiperight"===e?d._element.classList.contains("show")?d.hide():u._element.classList.contains("show")||u.show():"swipeleft"===e&&(u._element.classList.contains("show")?u.hide():d._element.classList.contains("show")||d.show())})),document.getElementById("shuffle-all").addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),r()})),document.getElementById("play").addEventListener("click",(e=>{p(e),document.activeElement?.blur()})),document.addEventListener("keyup",(function(e){{const e=document.getElementById("result-modal");if("none"!==window.getComputedStyle(e).getPropertyValue("display"))return void("Space"===event.code&&y())}switch(event.code){case"Space":p(e);break;case"Escape":E.isPlaying&&E.stop();break;case"KeyS":r();break;case"KeyO":E.isPlaying||B(0,!1);break;case"KeyC":o();break;case"KeyQ":document.getElementById("table-borders").checked=!l();break;case"KeyW":document.getElementById("ab-axes").checked=T.toggleVisibility();break;case"KeyA":document.getElementById("canonical-or-javascript").checked=a();break;case"ArrowRight":E.isPlaying||E.tortoiseHareAchilles.next();break;case"ArrowLeft":E.isPlaying||E.tortoiseHareAchilles.prev()}})),document.getElementById("play-again").addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),y()})),[...document.getElementsByClassName("carousel-item")].forEach((e=>{e.addEventListener("click",(e=>{if(e.preventDefault(),e.stopPropagation(),E.isPlaying)return;const t=e.target.getBoundingClientRect();event.clientX-t.left<t.width/2?E.tortoiseHareAchilles.prev():E.tortoiseHareAchilles.next()}))}))}));
