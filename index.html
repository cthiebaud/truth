<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Truth Tables</title>

    <!-- Open Graph data -->
    <meta property="og:locale" content="en_US">
    <meta property="og:title" content="Truth" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://truth.cthiebaud.com" />
    <meta property="og:description" content="Truth Tables" />
    <meta property="og:site_name" content="truth.cthiebaud.com" />

    <meta property="og:image" content="https://truth.cthiebaud.com/truth.jpg" />
    <meta property="og:image:url" content="https://truth.cthiebaud.com/truth.jpg" />
    <meta property="og:image:type" content="image/jpeg" />
    <meta property="og:image:width" content="1148" />
    <meta property="og:image:height" content="1660" />

    <link href="./favicon.ico" rel="icon" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@latest/dist/css/bootstrap.min.css">
    <style>
        .container {
            background-color: #f1efe0;
            color: #173F35;
            border-radius: 0.375rem;
            /* 1%; */
            /* PANTONE 567 C (closest to Sherwood Green) */
        }

        #tables>div {
            display: inline-block;
            margin: .25rem;
            padding: 0;
            border: lightgray 1px solid;
        }

        #tables.transparent-border>div {
            border: transparent 1px solid;
        }

        table.inline {
            display: inline-block;
            margin: 0;
        }

        table caption {
            white-space: nowrap;
            font-weight: bold;
            font-size: 18px;
            background-color: #FFFFFFa0;
            margin-bottom: .375rem;
            padding: .375rem 0;
        }

        table th {
            text-align: center;
            vertical-align: middle;
            font-weight: normal;
            font-size: 12px;
            padding: 1px !important;
            background-color: transparent !important;
        }

        table td {
            width: var(--cell-width);
            height: var(--cell-width);
            text-align: center;
            vertical-align: middle;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            font-size: 25px;
            padding: 0 1px 4px 0 !important;
        }

        .vertical-text {
            writing-mode: vertical-rl;
            /* Vertical writing mode, right to left */
            transform: rotate(180deg);
            /* Rotate the text 180 degrees */
        }

        .center-children {
            text-align: center;
        }
    </style>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=UnifrakturCook:wght@700&display=swap');
    </style>
    <!-- 
        <script type="text/javascript" src="https://livejs.com/live.js"></script>
    -->
</head>

<body class="font-monospace">
    <div id="con" class="container" style="visibility: hidden; max-width: 580px; padding:0;">
        <div class="p-2">
            <div class="btn-group float-end" role="group">
                <button id="AB" type="button" class="btn btn-light">
                    <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" width="18" height="18" viewBox="0 0 488 488">
                        <path
                            d="M487.9 40.927c-2.35 9.897-13.446 14.868-19.292 22.693-8.157 6.418-16.073 22.787-28.015 13.913-11.227-11.134 11.485-21.639 12.022-27.506H50.433v403.485c7.839-7.427 20.099-25.259 29.798-10.102 2.235 12.49-12.18 18.605-18.785 27.395-7.671 5.32-12.84 18.958-23.914 16.414-11.894-7.987-20.681-20.27-31.428-29.828-17.476-14.372 9.54-28.283 17.755-10.45 8.926 12.934 6.328-1.958 6.57-9.992V40.027c2.392-14.958 20.102-8.657 30.706-10.002h392.76C446.513 22.197 428.589 9.94 443.819.32c12.549-2.226 18.67 12.156 27.468 18.793 5.017 7.223 17.043 11.935 16.613 21.815z" />
                    </svg> </button>
                <button id="LF" type="button" class="btn btn-light">
                    <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" width="18" height="18" viewBox="0 0 14.963 14.974">
                        <path
                            d="M14.963 0H3.955A3.96 3.96 0 0 0 0 3.955a3.958 3.958 0 0 0 3.955 3.954h3.008v7.065h1V1h2.015v13.974h1V1h3.985zm-8 6.91H3.955A2.957 2.957 0 0 1 1 3.956a2.958 2.958 0 0 1 2.955-2.955h3.008z" />
                    </svg>
                </button>
                <button id="borders" type="button" class="btn btn-light">
                    <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" width="18" height="18" viewBox="0 0 16 16">
                        <g fill="#434343" fill-rule="evenodd">
                            <path
                                d="M13.048.99h1.993v1.987h.907V.057h-2.9V.99zM.923 3.008V.99h2.028V0H.027v3.008h.896zM2.951 15.03H.964v-1.95H.027v2.928h2.924v-.977zM15 5.013v2.01h.989v-2.01H15ZM15 9.013v1.961h.982v-1.96H15ZM9 .013V.98h1.984V.013H9ZM5 .013v.973h1.995V.013H5ZM9 15.013v.973h1.958v-.973H9ZM5 15.013v.993h1.987v-.993H5ZM0 5.013v1.99h.98v-1.99H0ZM0 9.013v1.962h.954V9.013H0ZM15.006 13.013v2.073H13v.946h3.003v-3.019h-.997z" />
                        </g>
                    </svg>
                </button>
                <button id="github" type="button" class="btn btn-light">
                    <svg width="18" height="18" viewBox="0 0 1024 1024" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z"
                            transform="scale(64)" fill="#1B1F23" />
                    </svg>

                </button>
            </div>
            <h2>(a,b) => &hellip;</h2>
        </div>
        <div id="tables" class="font-monospace center-children"></div>
        <h1 class="text-center py-2" style="font-family: 'UnifrakturCook', cursive; font-size: 72px;">Truth</h1>
    </div>
    <script type="module">
        import tinycolor from 'https://cdn.jsdelivr.net/npm/tinycolor2@latest/+esm'

        function setCellWidth(length) {
            let cellWidth = '56px'
            if (length === 3) {
                cellWidth = '52px'
            }
            document.documentElement.style.setProperty('--cell-width', cellWidth);
        }

        class Axes {
            constructor() {
                setCellWidth(this.axes.length)
            }
            axesSet = [[true, false], [null, true, false]]
            currentAxes = 0
            axes = this.axesSet[this.currentAxes]
            bump() {
                this.currentAxes = (this.currentAxes + 1) % this.axesSet.length
                this.axes = this.axesSet[this.currentAxes]
                setCellWidth(this.axes.length)
            }
        }
        let ab = new Axes()

        let lineBreaks = false // true // 


        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]]
            }
            // console.log("shuffled!")
        }

        // document.getElementById("con").style.backgroundColor = '#fedcba'
        class Colors {
            constructor() {
                shuffleArray(this.colors)
            }

            colorFalse = 'transparent'
            colorTrue = '#545955'
            colors = [
                '#F4F4F4',
                '#FAC80A',
                '#B40000',
                '#00852B',
                '#1E5AA8',
                '#8A928D',
                '#ABD9FF',
                '#91501C',
            ]
            currentColorIndex = 0
            nextColor = function () {
                const currentColor = this.colors[this.currentColorIndex++]
                this.currentColorIndex %= this.colors.length
                // console.log(index, currentColorIndex)
                if (this.currentColorIndex === 0) {
                    shuffleArray(this.colors)
                }
                return currentColor
            }
        }

        const colors = new Colors()

        const functions = [
            'false',
            0,
            'a & b',
            'a & !b',
            '!a & !b',
            '!a & b',
            0,
            'a',
            'b',
            '!a',
            '!b',
            'a == b',
            'a != b',
            0,
            'a | b',
            'a | !b',
            '!a | !b',
            '!a | b',
            0,
            'true',
        ]
        if (!lineBreaks) {
            // shuffleArray(functions)
        }

        function doIt() {

            let previousElement = null
            functions.forEach((func, index) => {
                const elementID = `element${index}`
                if (func === 0) {
                    if (lineBreaks) {
                        previousElement.insertAdjacentHTML("afterend", `<br id="${elementID}" style="display: block;">`)
                        previousElement = document.getElementById(elementID)
                    }
                } else {
                    const theadID = `thead${index}`
                    const tbodyID = `tbody${index}`
                    const template = `<div id="${elementID}">
    <table class="table inline table-sm caption-top table-borderless">
        <caption class="text-center">${func}</caption>
        <thead id="${theadID}"></thead>
        <tbody id="${tbodyID}"></tbody>
    </table>
</div>
`
                    if (previousElement === null) {
                        document.getElementById('tables').innerHTML = template
                    } else {
                        previousElement.insertAdjacentHTML("afterend", template)
                    }
                    let backgroundcolor
                    if (func === 'false') {
                        backgroundcolor = colors.colorFalse
                    } else if (func === 'true') {
                        backgroundcolor = colors.colorTrue
                    } else {
                        backgroundcolor = colors.nextColor()
                    }
                    ab.axes.forEach((rowElem, indexRow) => {
                        const row = document.createElement("tr")
                        ab.axes.forEach(colElem => {
                            // console.log(index, func, rowElem, colElem)
                            const col = document.createElement(rowElem === null || colElem === null ? "th" : "td")
                            row.appendChild(col)
                            if (colElem === null) {
                                if (rowElem === null) {
                                    col.innerHTML = '&nbsp;'
                                } else {
                                    col.innerHTML = `<div class="vertical-text">${rowElem}</div>`
                                }
                            } else {
                                if (rowElem === null) {
                                    col.innerHTML = colElem
                                } else {
                                    const a = rowElem
                                    const b = colElem
                                    const result = eval(func)
                                    if (result) {
                                        col.style.backgroundColor = result ? backgroundcolor : colors.colorFalse
                                        col.style.color = tinycolor(col.style.backgroundColor).darken(3).toString("hex6")
                                        if ((func === "a == b" || func === "a != b") && indexRow === 0) {
                                            backgroundcolor = colors.nextColor()
                                        }
                                    } else {
                                        col.style.color = col.style.backgroundColor = colors.colorFalse
                                    }
                                    col.innerHTML = result ? '●' /* '○' */ : '&nbsp;'
                                }
                            }
                        })
                        document.getElementById(rowElem === null ? theadID : tbodyID).appendChild(row)
                    });
                    previousElement = document.getElementById(elementID)
                }
            });
        }

        window.addEventListener("load", loadEvent => {
            doIt();
            (conElement => {
                conElement.style.visibility = 'visible'
                conElement.addEventListener('click', clickEvent => {
                    shuffleArray(colors)
                    doIt()
                    /*
                    setInterval(() => {
                        doIt()
                    }, 1000);
                    */
                })
            })(document.getElementById("con"))

            document.getElementById("AB").addEventListener('click', clickEvent => {
                clickEvent.preventDefault()
                clickEvent.stopPropagation()
                ab.bump()
                doIt()
            })
            document.getElementById("LF").addEventListener('click', clickEvent => {
                clickEvent.preventDefault()
                clickEvent.stopPropagation()
                lineBreaks = !lineBreaks
                if (lineBreaks) {
                    document.getElementById("tables").classList.remove("center-children")
                } else {
                    document.getElementById("tables").classList.add("center-children")
                }
                doIt()
            })
            document.getElementById("borders").addEventListener('click', clickEvent => {
                clickEvent.preventDefault()
                clickEvent.stopPropagation();
                (t => {
                    if (t.classList.contains("transparent-border")) {
                        t.classList.remove("transparent-border")
                    } else {
                        t.classList.add("transparent-border")
                    }
                })(document.getElementById("tables"))
            })
            document.getElementById("github").addEventListener('click', clickEvent => {
                clickEvent.preventDefault()
                clickEvent.stopPropagation();
                window.location = "https://github.com/cthiebaud/truth"
            })


        });

    </script>
</body>

</html>